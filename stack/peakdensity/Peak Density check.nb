(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7998,        224]
NotebookOptionsPosition[      6632,        197]
NotebookOutlinePosition[      7002,        213]
CellTagsIndexPosition[      6959,        210]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Load Data", "Section",ExpressionUUID->"aa7ef6c0-b2ea-4b5a-83a2-8b8023ea8d74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"0b005c7b-c56f-415e-a732-2ffc5fceece9"],

Cell["Set the name of the model to load the results from.", "Text",ExpressionUUID->"a8d181f7-cb4c-4d3d-bb38-9d752b15fbd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"modelname", "=", "\"\<toy_ps\>\""}], ";"}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"1dcffa44-0c4a-4342-9000-b9449dad94cc"],

Cell["Load the results.", "Text",ExpressionUUID->"aab7685f-66c1-48c2-a0cf-ee6c84591023"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "nuvals", ",", "min", ",", "saddleppm", ",", "saddlepmm", ",", "max", ",",
      "minerr", ",", "saddleppmerr", ",", "saddlepmmerr", ",", "maxerr", ",", 
     "signed"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
      "\"\<../../models/\>\"", "<>", "modelname", "<>", 
       "\"\</peakdensity.csv\>\""}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;"}], "]"}], "]"}], "//", "Transpose"}]}], 
  ";"}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"c9c49599-2870-4609-a2a4-0862920927bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vals", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\<../../models/\>\"", "<>", "modelname", "<>", 
      "\"\</moments-peaks.csv\>\""}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Sigma]0", ",", "\[Sigma]1"}], "}"}], "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"vals", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"d1f6287c-1d67-4d9a-8b0d-eb4d6e1f06fb"],

Cell["We have to set the number of fields manually.", "Text",ExpressionUUID->"166ef5ca-0ef2-4fe4-8c2a-bbc3b325f98f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "4"}], ";"}]], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"7725dd3f-978f-4180-9d3b-d6aba67e0c31"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Signed", "[", "\[Nu]_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"val", ",", "scale", ",", "alpha", ",", "dpdnu"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"val", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"n", "-", "2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"n", "-", "3"}], ")"}]}], "-", 
       RowBox[{"3", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], "^", "2"}], 
        RowBox[{"\[Nu]", "^", "2"}]}], "+", 
       RowBox[{"3", "n", " ", 
        RowBox[{"\[Nu]", "^", "4"}]}], "-", 
       RowBox[{"\[Nu]", "^", "6"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Nu]", ">", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"alpha", "=", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"6", "\[Pi]"}], ")"}], "^", "1.5"}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Sigma]1", "/", "\[Sigma]0"}], "/", "\[Nu]"}], ")"}], 
           "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dpdnu", "=", 
         RowBox[{
          RowBox[{"\[Nu]", "^", 
           RowBox[{"(", 
            RowBox[{"n", "-", "1"}], ")"}]}], 
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"\[Nu]", "^", "2"}]}], "/", "2"}], "]"}], "/", 
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"n", "/", "2"}], "-", "1"}], ")"}]}]}], "/", 
           RowBox[{"Gamma", "[", 
            RowBox[{"n", "/", "2"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"scale", "=", 
         RowBox[{"alpha", " ", "dpdnu"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", ">", "4"}], ",", 
          RowBox[{"scale", "=", "0"}], ",", 
          RowBox[{"scale", "=", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"6", "\[Pi]"}], ")"}], "^", "1.5"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Sigma]1", "/", "\[Sigma]0"}], ")"}], "^", "3"}], 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"\[Nu]", "^", "2"}]}], "/", "2"}], "]"}], "/", 
              RowBox[{"2", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"n", "/", "2"}], "-", "1"}], ")"}]}]}], "/", 
             RowBox[{"Gamma", "[", 
              RowBox[{"n", "/", "2"}], "]"}]}]}]}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"val", " ", "scale"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"1a071d39-0fb1-4815-a731-3674a5a78c93"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Signed", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "6"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"0a75912d-ce54-44a7-b3d7-69b46db8dd49"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"nuvals", ",", 
      RowBox[{"min", "-", "saddleppm", "+", "saddlepmm", "-", "max"}]}], 
     "}"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellLabel->"In[34]:=",ExpressionUUID->"a3c0c879-7e0b-4f38-9ce8-ba1842f9fde9"]
}, Open  ]]
},
WindowSize->{1440, 795},
WindowMargins->{{1897, Automatic}, {Automatic, 291}},
TrackCellChangeTimes->False,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 83, 0, 67, "Section",ExpressionUUID->"aa7ef6c0-b2ea-4b5a-83a2-8b8023ea8d74"],
Cell[666, 24, 201, 4, 30, "Input",ExpressionUUID->"0b005c7b-c56f-415e-a732-2ffc5fceece9"],
Cell[870, 30, 122, 0, 35, "Text",ExpressionUUID->"a8d181f7-cb4c-4d3d-bb38-9d752b15fbd7"],
Cell[995, 32, 166, 3, 30, "Input",ExpressionUUID->"1dcffa44-0c4a-4342-9000-b9449dad94cc"],
Cell[1164, 37, 88, 0, 35, "Text",ExpressionUUID->"aab7685f-66c1-48c2-a0cf-ee6c84591023"],
Cell[1255, 39, 609, 17, 30, "Input",ExpressionUUID->"c9c49599-2870-4609-a2a4-0862920927bb"],
Cell[1867, 58, 596, 17, 52, "Input",ExpressionUUID->"d1f6287c-1d67-4d9a-8b0d-eb4d6e1f06fb"],
Cell[2466, 77, 116, 0, 35, "Text",ExpressionUUID->"166ef5ca-0ef2-4fe4-8c2a-bbc3b325f98f"],
Cell[2585, 79, 146, 3, 30, "Input",ExpressionUUID->"7725dd3f-978f-4180-9d3b-d6aba67e0c31"],
Cell[2734, 84, 3205, 90, 220, "Input",ExpressionUUID->"1a071d39-0fb1-4815-a731-3674a5a78c93"],
Cell[5942, 176, 302, 7, 30, "Input",ExpressionUUID->"0a75912d-ce54-44a7-b3d7-69b46db8dd49"],
Cell[6247, 185, 369, 9, 30, "Input",ExpressionUUID->"a3c0c879-7e0b-4f38-9ce8-ba1842f9fde9"]
}, Open  ]]
}
]
*)

